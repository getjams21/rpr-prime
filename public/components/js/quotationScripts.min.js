function triggerAddItem(t){$("tr#rowID"+t).hide(),$.post(getItem,{id:t,token:_token},function(t){if(t){var n=t.price;$("table#quoteTable").find("tbody#quoteBody").append('\n				<tr id="trow'+num+'">\n					<td>'+t.name+"</td>\n					<td>"+t.description+"</td>\n					<td>"+t.model+"</td>\n					<td>"+t.unit+'</td>\n					<td id="qty'+num+'" class="qty" contenteditable>1</td>\n					<td class="price" id="price'+num+'" contenteditable>'+numeral(n).format("0,0.00")+'</td>\n					<td> <button class="btn btn-danger btn-sm remove" id="'+num+'" type="button">Remove</button></td>\n					<input type="hidden" id="itemID'+num+'" name="id['+num+']" value="'+t.id+'">\n					<input type="hidden" id="quantity'+num+'" name="quantity['+num+']" value="'+t.quantity+'">\n					<input type="hidden" id="origPrice'+num+'" value="'+n+'">\n					<input type="hidden" id="itemPrice'+num+'" name="price['+num+']" value="'+numeral(n).format("0.00")+'">\n				</tr>\n			')}num++,runningPrice=parseFloat(runningPrice)+parseFloat(n),$("td#runningPrice").html(numeral(runningPrice).format("0,0.00").bold())})}function triggerViewItems(t,n,e,o,i,r,a,d,u,l,c){1==r?($(".btn-edit-quotation").remove(),$("#btns").prepend('\n			<button type="button" class="btn btn-primary btn-print-quotation" style="min-width:100px;">Print</button>\n		')):$(".btn-save-quotation").remove(),$("#projectName").val(e),$("#quotation_id").val(t),$("#user_id").val(i),$("#customer_id").append('\n		<option value="'+o+'">'+n+"</option"),$.post(itemViewURL,{id:t,token:_token},function(t){var o,i=0;if(t){var r=1;$.each($(t),function(t,n){var e=n.adjusted_price,a=n.quantity,d=e/a;i+=parseFloat(e),o=n.customID,$("table#quoteTable").find("tbody").append('\n					<tr id="trow'+r+'">\n						<td><img src="'+APP_URL+n.link+'" class="img-thumbnail" width="100" height="100"></td>\n						<td>'+n.name+"</td>\n						<td>"+n.description+"</td>\n						<td>"+n.model+"</td>\n						<td>"+n.unit+'</td>\n						<td id="qty'+r+'" class="qty">'+n.quantity+'</td>\n						<td class="price" id="price'+r+'">'+numeral(e).format("0,0.00")+'</td>\n						<input type="hidden" id="itemID'+r+'" name="id['+r+']" value="'+n.id+'">\n						<input type="hidden" id="quantity'+r+'" name="quantity['+r+']" value="'+n.quantity+'">\n						<input type="hidden" id="origPrice'+r+'" value="'+d+'">\n						<input type="hidden" id="qDetails_id'+r+'" name="qDetails_id['+r+']" value="'+n.qDetail_id+'">\n						<input type="hidden" id="itemPrice'+r+'" name="price['+r+']" value="'+numeral(e).format("0.00")+'">\n						<td class="remove-op" hidden> <button class="btn btn-danger btn-sm remove" id="'+r+'" type="button">Remove</button></td>\n					</tr>\n				'),r++})}var m=i-a,s=.12*m,p=m+s;origSubtotal=m,$("td#discPrice").html(numeral(a).format("0,0.00").bold()),$("#discount").val(a),$("span#vat").html(numeral(s).format("0,0.00").bold()),$("label#gTotal").html(numeral(p).format("0,0.00").bold()),$("#quotation-details").html('\n			<div class="col-md-4 col-md-offset-2">\n              Company/Customer: <b>'+n+"</b> <br>\n              Address: <b>"+d+"</b> <br>\n              Project Name: <b>"+e+'</b>\n            </div>\n            <div class="col-md-4">\n              Contact Person: <b>'+u+"</b> <br>\n              Telephone No.: <b>"+l+"</b> <br>\n              Email Address: <b>"+c+"</b>\n            </div>\n		"),$("#runningPrice").html(numeral(i).format("0,0.00").bold()),$("#preview-items").modal("show")})}var _token=$('meta[name="csrf-token"]').attr("content");$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var num=1,runningPrice=0,prevPrice=0,origPrice=[],origSubtotal;$(document).on("focusout",".qty",function(t){var n=t.target.id;n=n.substr(3,1);var e=parseInt($("td#qty"+n).text()),o=$("#quoteTable >tbody >tr").length,i=parseFloat($("#origPrice"+n).val()),r=e*i,a=0;$("td#price"+n).text(numeral(r).format("0,0.00")),$("#itemPrice"+n).val(numeral(r).format("0.00"));for(var d=1;o>=d;d++)a+=parseFloat(numeral($("td#price"+d).text()).format("0.00"));runningPrice=a;var u=parseFloat($("#discount").val()),l=runningPrice-u,c=.12*l,m=l+c;$("span#vat").text(c),$("td#gTotal").text(m),$("td#runningPrice").html(numeral(runningPrice).format("0,0.00").bold()),$("#quantity"+n).val(e)}),$(document).on("click",".remove",function(t){var n=t.target.id,e=(numeral($("td#price"+n).text()).format("0.00"),$("#itemID"+n).val()),o=$("#quoteTable >tbody >tr").length;$("tr#trow"+n).empty(),$("tr#rowID"+e).show();for(var i=0,r=1;o>=r;r++)i+=parseFloat(numeral($("td#price"+r).text()).format("0.00"));runningPrice=i,$("td#runningPrice").html(numeral(runningPrice).format("0,0.00").bold())}),$(document).on("click",".price",function(t){var n=t.target.id;prevPrice=$("#"+n).text()}),$(document).on("focusout",".price",function(t){var n=t.target.id,e=$("#"+n).text(),o=$("#quoteTable >tbody >tr").length;if(e=parseFloat(numeral(e).format("0.00")),prevPrice=parseFloat(numeral(prevPrice).format("0.00")),e>prevPrice){var i=e-prevPrice;runningPrice+=i}else if(prevPrice>e){var r=prevPrice-e;runningPrice-=r}var a=n.substr(5,1);$("#itemPrice"+a).val(numeral(e).format("0.00"));for(var e=0,d=1;o>=d;d++)e+=parseFloat(numeral($("td#price"+d).text()).format("0.00"));runningPrice=e,$("td#runningPrice").html(numeral(runningPrice).format("0,0.00").bold())}),$(document).on("click",".btn-edit-quotation",function(){for(var t,n=$("#quoteTable >tbody >tr").length,e=1;n>=e;e++)$("td#qty"+e).attr("contenteditable","true"),$("td#price"+e).attr("contenteditable","true"),t=$("#itemID"+e).val(),$("#rowID"+t).hide();$("td#discPrice").attr("contenteditable","true"),$(".edit-quotation").show(),$(".remove-op").show(),$("#btns").prepend('\n		<button type="button" class="btn btn-success btn-deal-quotation" style="min-width:100px;">Deal</button>\n		<button type="submit" class="btn btn-info btn-save-quotation" style="min-width:100px;">Save</button>\n	'),$("#cancel-group").show(),$(this).hide()}),$(document).on("click",".btn-deal-quotation",function(){var t=$("#quotation_id").val();$.post(dealProject,{id:t,token:_token},function(){window.location.href="quotations"})}),$(document).on("click",".btn-print-quotation",function(){var t=APP_URL+"/bower_components/admin-lte/bootstrap/css/bootstrap.min.css",n=APP_URL+"/bower_components/admin-lte/fontawesome/css/font-awesome.min.css",e=APP_URL+"/bower_components/admin-lte/fontawesome/ionicons.min.css",o=APP_URL+"/bower_components/admin-lte/dist/css/AdminLTE.min.css",i=APP_URL+"/bower_components/admin-lte/dist/css/skins/skin-blue.min.css",r=APP_URL+"/components/css/mystyle.min.css";$("#preview-items").printThis({debug:!1,importCSS:!0,importStyle:!0,printContainer:!0,loadCSS:[t,n,e,o,i,r],removeInline:!1,printDelay:333,header:null,formValues:!0})}),$(document).on("keyup","#discPrice",function(){var t=parseFloat($(this).text());$("#discount").val(t);var n=origSubtotal;isNaN(t)||(n-=t);var e=.12*n,o=n+e;$("span#vat").html(numeral(e).format("0,0.00").bold()),$("label#gTotal").html(numeral(o).format("0,0.00").bold())}),jQuery(document).ready(function(t){t("#searchCustomer").keyup(function(){t("#customer_id").empty();var n=t(this).val();t.post(customerSearch,{key:n,token:_token},function(n){return n?(t.each(t(n),function(n,e){""!=e&&t("#customer_id").append('\n				      	<option class="" value="'+e.id+'">'+e.first_name+" "+e.last_name+"</option>\n			        ")}),!1):void 0})}),t(".close-item-modal").click(function(){t(".btn-edit-quotation").remove(),t("tbody#quoteBody > tr").remove(),t("td#runningPrice").html(numeral(0).format("0.00").bold()),t(".btn-save-quotation").remove(),t(".edit-quotation").hide(),t("#cancel-group").hide(),t(".btn-edit-quotation").show(),t(".btn-deal-quotation").hide(),t(".btn-print-quotation").remove();for(var n=t("#quoteTable >tbody >tr").length,e=1;n>=e;e++)t("td#qty"+e).removeAttr("contenteditable"),t("td#price"+e).removeAttr("contenteditable");t("#btns").prepend('\n			<button type="button" class="btn btn-primary btn-edit-quotation" style="min-width:100px;">Edit</button>\n		'),t("td#discPrice"+e).attr("contenteditable",!1)}),t("#cancelQuotation").click(function(){this.checked?(t(".cancel-reason").append('\n	          <label>Reason for Cancellation <font color="red">*</font></label>\n	          <textarea class="form-control" name="cancel_reason" style="max-width:400px;min-height:80px;" placeholder="Please state your reason why you have to cancel this quotation" required></textarea>\n			'),t(".btn-deal-quotation").hide()):(t(".cancel-reason").empty(),t(".btn-deal-quotation").show())})});